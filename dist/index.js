(()=>{"use strict";class e{x;y;constructor(e,t){this.x=e,this.y=t}}class t{coords;color;onAction;constructor(e,t,o){this.coords=e,this.color=t,this.onAction=o}}const o=25,n=600,c=document.querySelector("#startBtn"),r=document.querySelector("#stopBtn"),s=document.querySelector("#canvas"),a=document.querySelector("#score"),l=s.getContext("2d");let i,d,y=new e(300,300),u=new e(0,1),w=1,h=[],f=[];function x(){l.fillStyle="white",l.clearRect(0,0,n,n),y.x+=o*u.x,y.y+=o*u.y,function(){const e=f.find((e=>e.coords.x===y.x&&e.coords.y===y.y));return void 0!==e&&(f=f.filter((t=>t!==e)),e.onAction(),a.innerHTML=w+"",!0)}()||h.splice(0,1),(y.x<0||y.x>=n||y.y<0||y.y>=n||m(y))&&(v(),alert("Game over.")),h.push(new e(y.x,y.y)),h.forEach((e=>A(e,"green"))),f.forEach((e=>A(e.coords,e.color)))}function v(){c.disabled=!1,clearInterval(d)}function m(e){return h.some((t=>t.x===e.x&&t.y===e.y))}function k(){const n=new e(Math.floor(24*Math.random())*o,Math.floor(24*Math.random())*o);m(n)?k():0!==Math.floor(5*Math.random())?f.push(new t(n,"red",(()=>{k(),i/=i<100?1.08:1.25,clearInterval(d),w++,d=setInterval(x,i)}))):f.push(new t(n,"blue",(()=>{k(),i/=i<100?1.25:1.5,clearInterval(d),w+=2,d=setInterval(x,i)})))}function A(e,t,n="white"){l.fillStyle=t,l.strokeStyle=n,l.fillRect(e.x,e.y,o,o),l.strokeRect(e.x,e.y,o,o)}c.addEventListener("click",(function(){c.disabled=!0,i=300,d=setInterval(x,i),y=new e(300,300),h=[],f=[],k(),w=1,a.innerHTML=w+""})),r.addEventListener("click",v),window.addEventListener("keydown",(t=>{switch(!0){case"KeyW"===t.code&&0===u.y:case"ArrowUp"===t.code&&0===u.y:u=new e(0,-1);break;case"KeyS"===t.code&&0===u.y:case"ArrowDown"===t.code&&0===u.y:u=new e(0,1);break;case"KeyA"===t.code&&0===u.x:case"ArrowLeft"===t.code&&0===u.x:u=new e(-1,0);break;case"KeyD"===t.code&&0===u.x:case"ArrowRight"===t.code&&0===u.x:u=new e(1,0)}}))})();